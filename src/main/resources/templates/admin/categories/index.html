<!DOCTYPE html>
<html lang="en"   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org" layout:decorate="~{admin/layout/admin_layout}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>

<header>
  <nav>
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="/admin/home" class="nav-link">Trang Chủ</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="/admin/category" class="nav-link">Danh mục</a>
      </li>
    </ul>
  </nav>
</header>

<!-- Define a section called "naviheader" -->
<section th:fragment="naviheader"></section>
<!-- Content Header (Page header) -->
<section class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1>Quản Lý Danh Mục</h1>
      </div>
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
          <li class="breadcrumb-item"><a href="#">Home</a></li>
          <li class="breadcrumb-item active">Danh Mục</li>
        </ol>
      </div>
    </div>
  </div><!-- /.container-fluid -->
</section>

<!-- Main content -->
<section class="content">

  <!-- Default box -->
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Danh sách danh mục</h3>

      <div class="card-tools">
        <a href="/admin/category/add" class="btn btn-primary">Thêm Mới</a>
      </div>
    </div>
    <div class="card-body">

    </div>
    <!-- /.card-body -->
    <div class="card-footer">
      <table class="table table-hover">
        <thead>
        <tr>
          <th>STT</th>
          <th>Tên Danh Mục</th>
          <th>Thứ Tự</th>
          <th></th>
        </tr>
        </thead>
        <tbody>
        @if (Model != null && Model.Any())
        {
        var i = 1;
        foreach (var item in Model)
        {
        <tr id="trow_@item.Id">
          <td>@i</td>
          <td>@item.Title</td>
          <td>@item.Position</td>
          <td>
            <a href="/admin/category/edit/@item.Id" class="btn btn-sm btn-primary">Sửa</a>
            <a href="#" data-id="@item.Id" class="btn btn-sm btn-danger btnDelete">Xóa</a>
          </td>
        </tr>
        i++;
        }
        }
        else
        {
        <tr>
          <td colspan="4">Không có bản ghi nào!!!</td>
        </tr>
        }
        </tbody>
      </table>
    </div>
    <!-- /.card-footer-->
  </div>
  <!-- /.card -->

</section>
<!-- /.content -->
<script>
    $(document).ready(function() {
        $('body').on('click', '.btnDelete', function() {
            var id = $(this).data("id");
            var conf = confirm('Do you want to delete??');
            if (conf === true) {
                axios.post('/admin/category/delete', { id: id })
                    .then(function(response) {
                        if (response.data.success) {
                            $('#trow_' + id).remove();
                        }
                    })
                    .catch(function(error) {
                        console.log(error);
                    });
            }
        });
    });
</script>

</body>
</html>